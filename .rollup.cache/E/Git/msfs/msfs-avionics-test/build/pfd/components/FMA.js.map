{"version":3,"file":"FMA.js","sourceRoot":"","sources":["../../../pfd/components/FMA.tsx"],"names":[],"mappings":"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","sourcesContent":["//import { createDeltaTimeCalculator, getSimVar, renderTarget } from '../util.js';\r\n\r\nimport { DisplayComponent, EventBus, FSComponent, NodeReference, Subject, Subscribable, VNode } from \"msfssdk\";\r\nimport { Arinc429Word } from \"../shared/arinc429\";\r\nimport { PFDSimvarPublisher, PFDSimvars } from \"../shared/PFDSimvarPublisher\";\r\n\r\nabstract class ShowForSecondsComponent<T> extends DisplayComponent<T>  {\r\n\r\n    private timeout: number = 0;\r\n\r\n    protected modeChangedPathRef = FSComponent.createRef<SVGPathElement>();\r\n    protected displayModeChangedPath = (timeout: number, cancel = false) => {\r\n        \r\n        if(cancel) {\r\n            clearTimeout(this.timeout);\r\n            this.modeChangedPathRef.instance.classList.remove('ModeChangedPath');\r\n        } else {\r\n            this.modeChangedPathRef.instance.classList.add('ModeChangedPath');\r\n            clearTimeout(this.timeout);\r\n            this.timeout = setTimeout(() => {\r\n                this.modeChangedPathRef.instance.classList.remove('ModeChangedPath');\r\n              }, timeout) as unknown as number;\r\n        }\r\n      \r\n    }\r\n}\r\n\r\nexport class FMA extends DisplayComponent<{ bus: EventBus }>  {\r\n\r\n\r\n    private isAttExcessive = false;\r\n\r\n    private isAttExcessiveSub = Subject.create(false);\r\n    private hiddenClassSub = Subject.create('');\r\n\r\n\r\n    private roll: Arinc429Word = new Arinc429Word(0);\r\n    private pitch: Arinc429Word = new Arinc429Word(0);;\r\n    private activeLateralMode: number = 0;\r\n    private activeVerticalMode: number = 0;\r\n\r\n    private firstBorderRef = FSComponent.createRef<SVGPathElement>();\r\n    private secondBorderRef = FSComponent.createRef<SVGPathElement>();\r\n\r\n\r\n    private attExcessive(pitch: Arinc429Word, roll: Arinc429Word): boolean {\r\n        if (!this.isAttExcessive && ((pitch.isNormalOperation() && (-pitch.value > 25 || -pitch.value < -13)) || (roll.isNormalOperation() && Math.abs(roll.value) > 45))) {\r\n            this.isAttExcessive = true;\r\n            return true;\r\n        } else if (this.isAttExcessive && pitch.isNormalOperation() && -pitch.value < 22 && -pitch.value > -10 && roll.isNormalOperation() && Math.abs(roll.value) < 40) {\r\n            this.isAttExcessive = false;\r\n            return false;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const fm = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        fm.on('roll').handle(r => {\r\n            this.roll = new Arinc429Word(r);\r\n        });\r\n\r\n        fm.on('pitch').handle(p => {\r\n            this.pitch = new Arinc429Word(p);\r\n        });\r\n\r\n        fm.on('activeLateralMode').whenChanged().handle(activeLateralMode => {\r\n\r\n            const isAttExcessive = this.attExcessive(this.pitch, this.roll);\r\n\r\n            this.isAttExcessiveSub.set(isAttExcessive);\r\n            const sharedModeActive = activeLateralMode === 32 || activeLateralMode === 33 || activeLateralMode === 34 || (activeLateralMode === 20 && this.activeVerticalMode === 24);\r\n            const BC3Message = getBC3Message(isAttExcessive)[0] !== null;\r\n\r\n            const engineMessage = SimVar.GetSimVarValue('L:A32NX_AUTOTHRUST_MODE_MESSAGE', 'enum');\r\n                const AB3Message = (SimVar.GetSimVarValue('L:A32NX_MachPreselVal', 'mach') !== -1\r\n                || SimVar.GetSimVarValue('L:A32NX_SpeedPreselVal', 'knots') !== -1) && BC3Message && engineMessage === 0;\r\n\r\n            let secondBorder: string;\r\n            if (sharedModeActive && !isAttExcessive) {\r\n                secondBorder = '';\r\n            } else if (BC3Message) {\r\n                secondBorder = 'm66.241 0.33732v15.766';\r\n            } else {\r\n                secondBorder = 'm66.241 0.33732v20.864';\r\n            }\r\n\r\n            let firstBorder: string;\r\n            if (AB3Message && !isAttExcessive) {\r\n                firstBorder = 'm33.117 0.33732v15.766';\r\n            } else {\r\n                firstBorder = 'm33.117 0.33732v20.864';\r\n            }\r\n\r\n            this.firstBorderRef.instance.setAttribute('d',firstBorder);\r\n            this.secondBorderRef.instance.setAttribute('d', secondBorder);\r\n        });\r\n            fm.on('activeVerticalMode').whenChanged().handle(activeVerticalMode => {\r\n                const isAttExcessive = this.attExcessive(this.pitch, this.roll);\r\n                const sharedModeActive = this.activeLateralMode === 32 || this.activeLateralMode === 33 || this.activeLateralMode === 34 || (this.activeLateralMode === 20 && activeVerticalMode === 24);\r\n                const BC3Message = getBC3Message(isAttExcessive)[0] !== null;\r\n\r\n                const engineMessage = SimVar.GetSimVarValue('L:A32NX_AUTOTHRUST_MODE_MESSAGE', 'enum');\r\n                const AB3Message = (SimVar.GetSimVarValue('L:A32NX_MachPreselVal', 'mach') !== -1\r\n                || SimVar.GetSimVarValue('L:A32NX_SpeedPreselVal', 'knots') !== -1) && BC3Message && engineMessage === 0;\r\n    \r\n                let secondBorder: string;\r\n                if (sharedModeActive && !isAttExcessive) {\r\n                    secondBorder = '';\r\n                } else if (BC3Message) {\r\n                    secondBorder = 'm66.241 0.33732v15.766';\r\n                } else {\r\n                    secondBorder = 'm66.241 0.33732v20.864';\r\n                }\r\n\r\n                let firstBorder: string;\r\n                if (AB3Message && !isAttExcessive) {\r\n                    firstBorder = 'm33.117 0.33732v15.766';\r\n                } else {\r\n                    firstBorder = 'm33.117 0.33732v20.864';\r\n                }\r\n\r\n                this.hiddenClassSub.set(isAttExcessive?'hidden':'visible');\r\n\r\n                this.firstBorderRef.instance.setAttribute('d',firstBorder);\r\n                this.secondBorderRef.instance.setAttribute('d', secondBorder);\r\n     \r\n        });\r\n    }\r\n\r\n    render(): VNode  {\r\n\r\n\r\n\r\n    \r\n        return (\r\n            <g id=\"FMA\">\r\n                <g class=\"NormalStroke Grey\">\r\n                    <path ref={this.firstBorderRef}  />\r\n                    <path ref={this.secondBorderRef}  />\r\n                    <path d=\"m102.52 0.33732v20.864\" />\r\n                    <path d=\"m133.72 0.33732v20.864\" />\r\n                </g>\r\n    \r\n                <Row1 bus={this.props.bus} hiddenClassSub={this.hiddenClassSub} />\r\n                <Row2 bus={this.props.bus} hiddenClassSub={this.hiddenClassSub} />\r\n                <Row3 bus={this.props.bus} hiddenClassSub={this.hiddenClassSub} isAttExcessiveSub={this.isAttExcessiveSub} />\r\n            </g>\r\n        );\r\n\r\n    }\r\n    \r\n};\r\n\r\nclass Row1 extends DisplayComponent<{ bus:EventBus, hiddenClassSub: Subscribable<string> }> {\r\n    render(): VNode  {\r\n        return  <g>\r\n        <A1A2Cell bus={this.props.bus} />\r\n\r\n            <>\r\n                <B1Cell visibility={this.props.hiddenClassSub} bus={this.props.bus}  />\r\n                <C1Cell visibility={this.props.hiddenClassSub} bus ={this.props.bus} />\r\n                <D1D2Cell visibility={this.props.hiddenClassSub} bus={this.props.bus} />\r\n                <BC1Cell visibility={this.props.hiddenClassSub} bus={this.props.bus} />\r\n            </>\r\n        <E1Cell bus={this.props.bus} />\r\n    </g>\r\n\r\n    }\r\n\r\n}\r\n\r\nclass Row2 extends DisplayComponent<{ bus:EventBus, hiddenClassSub: Subscribable<string> }> {\r\n\r\n    render(): VNode {\r\n        return(\r\n            <g>\r\n             <g visibility={this.props.hiddenClassSub}>\r\n                <B2Cell bus={this.props.bus}/>\r\n                <C2Cell bus={this.props.bus} />\r\n            </g>\r\n        <E2Cell bus={this.props.bus}/>\r\n    </g>)\r\n    }\r\n    \r\n}\r\n \r\nclass Row3 extends DisplayComponent<{ bus:EventBus, hiddenClassSub: Subscribable<string>, isAttExcessiveSub: Subscribable<boolean> }> {\r\n    render(): VNode {\r\n\r\n        return( \r\n        <g>\r\n            <A3Cell bus={this.props.bus}/>\r\n                <g visibility={this.props.hiddenClassSub}>\r\n                    <AB3Cell bus={this.props.bus} />\r\n                    <D3Cell bus={this.props.bus}/>\r\n                </g>\r\n            <BC3Cell isAttExcessive={this.props.isAttExcessiveSub} />\r\n            <E3Cell bus={this.props.bus} />\r\n        </g>)\r\n    }\r\n   \r\n} \r\n\r\n\r\n\r\nclass A1A2Cell extends ShowForSecondsComponent<{bus: EventBus}> {\r\n\r\n\r\n    private athrModeSub = Subject.create(0);\r\n\r\n    private cellRef = FSComponent.createRef<SVGGElement>();\r\n  \r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('AThrMode').whenChanged().handle(athrMode => {\r\n\r\n           \r\n\r\n            this.athrModeSub.set(athrMode);\r\n\r\n            let text: string = '';\r\n            switch (athrMode) {\r\n                case 1:\r\n                    text = \r\n                        `\r\n                            <path class=\"NormalStroke White\" d=\"m24.023 1.8143v13.506h-15.048v-13.506z\" />\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.558302\" y=\"6.8888531\">MAN</text>\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.511532\" y=\"14.232082\">TOGA</text>\r\n                        `\r\n                     break; \r\n                case 2:\r\n                    text = \r\n                        `<g>\r\n                            <path class=\"NormalStroke White\" d=\"m29.776 1.8143v13.506h-26.414v-13.506z\" />\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.558302\" y=\"6.8888531\">MAN</text>\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.511532\" y=\"14.232082\">GA SOFT</text>\r\n                        </g>`\r\n                     break; \r\n                case 3: \r\n                    const FlexTemp = Math.round(SimVar.GetSimVarValue('L:AIRLINER_TO_FLEX_TEMP', 'number'));\r\n                    const FlexText = FlexTemp >= 0 ? (`+${FlexTemp}`) : FlexTemp.toString();\r\n                    text = \r\n                        `<g>\r\n                            <path class=\"NormalStroke White\" d=\"m31.521 1.8143v13.506h-30.217v-13.506z\" />\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.558302\" y=\"6.8888531\">MAN</text>\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.511532\" y=\"14.232082\">\r\n                                <tspan xmlSpace=\"preserve\">FLX  </tspan>\r\n                                <tspan class=\"Cyan\">${FlexText}</tspan>\r\n                            </text>\r\n                        </g>`\r\n                    \r\n                    break; \r\n                case 4:\r\n                    text = \r\n                        `<g>\r\n                            <path class=\"NormalStroke White\" d=\"m23.172 1.8143v13.506h-12.99v-13.506z\" />\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.558302\" y=\"6.8888531\">MAN</text>\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.511532\" y=\"14.232082\">DTO</text>\r\n                        </g>`\r\n                     break; \r\n                case 5:\r\n                    \r\n                        text =  `<g>\r\n                            <path class=\"NormalStroke White\" d=\"m23.172 1.8143v13.506h-12.99v-13.506z\" />\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.558302\" y=\"6.8888531\">MAN</text>\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.511532\" y=\"14.232082\">MCT</text>\r\n                        </g>`\r\n                    break; \r\n                case 6:\r\n                    text = \r\n                        `<g>\r\n                            <path class=\"NormalStroke Amber\" d=\"m23.172 1.8143v13.506h-12.99v-13.506z\" />\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.558302\" y=\"6.8888531\">MAN</text>\r\n                            <text class=\"FontMedium MiddleAlign White\" x=\"16.511532\" y=\"14.232082\">THR</text>\r\n                        </g>`\r\n                    break; \r\n                case 7:\r\n                    text = `<text  class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">SPEED</text>`\r\n                    this.displayModeChangedPath(9000);\r\n                    break;\r\n                case 8:\r\n                    text = `<text  class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">MACH</text>`;\r\n                    this.displayModeChangedPath(9000);\r\n                    break;\r\n                case 9:\r\n                    text = `<text  class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">THR MCT</text>`;\r\n                    this.displayModeChangedPath(9000);\r\n                    break;\r\n                case 10:\r\n                    text = `<text  class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">THR CLB</text>`;\r\n                    this.displayModeChangedPath(9000);\r\n                    break;\r\n                case 11:\r\n                    text = `<text  class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">THR LVR</text>`;\r\n                    this.displayModeChangedPath(9000);\r\n                    break;\r\n                case 12:\r\n                    text = `<text  class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">THR IDLE</text>`;\r\n                    this.displayModeChangedPath(9000);\r\n                    break;\r\n                case 13:\r\n                    text = \r\n                        `<g>\r\n                            <path class=\"NormalStroke Amber BlinkInfinite\" d=\"m0.70556 1.8143h30.927v6.0476h-30.927z\" />\r\n                            <text class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">A.FLOOR</text>\r\n                        </g>`\r\n                    break;\r\n                case 14:\r\n                    text = \r\n                        `<g>\r\n                            <path class=\"NormalStroke Amber BlinkInfinite\" d=\"m0.70556 1.8143h30.927v6.0476h-30.927z\" />\r\n                            <text class=\"FontMedium MiddleAlign Green\" x=\"16.158028\" y=\"6.8888531\">TOGA LK</text>\r\n                        </g>`\r\n                    break;\r\n                default:\r\n                    text = '';\r\n                }\r\n\r\n                this.cellRef.instance.innerHTML = text;\r\n                if(text==='') {\r\n                    this.displayModeChangedPath(0, true);\r\n                }\r\n\r\n        });\r\n\r\n    }\r\n\r\n    render(): VNode {\r\n\r\n    \r\n    \r\n        return (\r\n            <>\r\n          \r\n                <path ref={this.modeChangedPathRef} visibility='hidden' class=\"NormalStroke White\" d=\"m0.70556 1.8143h30.927v6.0476h-30.927z\" />\r\n           \r\n                <g ref={this.cellRef}>\r\n           \r\n            </g>\r\n            </>\r\n        );\r\n    }\r\n   \r\n}\r\n\r\n\r\n class A3Cell extends DisplayComponent<{bus: EventBus}> {\r\n\r\n    private classSub = Subject.create('');\r\n    private textSub = Subject.create('');\r\n\r\n    private onUpdateAthrModeMessage(message: number) {\r\n        let text: string='';\r\n        let className: string='';\r\n        switch (message) {\r\n        case 1:\r\n            text = 'THR LK';\r\n            className = 'Amber BlinkInfinite';\r\n            break;\r\n        case 2:\r\n            text = 'LVR TOGA';\r\n            className = 'White BlinkInfinite';\r\n            break;\r\n        case 3:\r\n            text = 'LVR CLB';\r\n            className = 'White BlinkInfinite';\r\n            break;\r\n        case 4:\r\n            text = 'LVR MCT';\r\n            className = 'White BlinkInfinite';\r\n            break;\r\n        case 5:\r\n            text = 'LVR ASYM';\r\n            className = 'Amber';\r\n            break;\r\n        }\r\n        this.textSub.set(text);\r\n        this.classSub.set(`FontMedium MiddleAlign ${className}`);\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('athrModeMessage').whenChanged().handle(m => {\r\n            this.onUpdateAthrModeMessage(m);\r\n        })\r\n        \r\n    }\r\n\r\n    render(): VNode {\r\n        return (\r\n            <text class={this.classSub} x=\"16.511532\" y=\"21.481768\">{this.textSub}</text>\r\n        );\r\n    }\r\n   \r\n}\r\n \r\n class AB3Cell extends DisplayComponent<{bus: EventBus}> {\r\n\r\n    private speedPreselVal = -1;\r\n    private machPreselVal = -1;\r\n    private athrModeMessage = 0;\r\n\r\n    private textSub = Subject.create('');\r\n\r\n    private getText() {\r\n        if(this.athrModeMessage === 0) {\r\n\r\n            console.log(\"speed prese \"+this.speedPreselVal);\r\n            console.log(\"mach prese \"+this.machPreselVal);\r\n\r\n        \r\n        if(this.speedPreselVal !== -1 && this.machPreselVal === -1){\r\n            \r\n            const text = Math.round(this.speedPreselVal);\r\n            this.textSub.set(`SPEED SEL ${text}`)\r\n        } else if(this.machPreselVal !== -1 && this.speedPreselVal === -1) {\r\n            this.textSub.set(`MACH SEL ${this.machPreselVal.toFixed(2)}`);\r\n        } else if( this.machPreselVal === -1 && this.speedPreselVal === -1) {\r\n            this.textSub.set('');\r\n        }\r\n    } else {\r\n        this.textSub.set('');\r\n    }\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('speedPreselVal').whenChanged().handle(m => {\r\n            this.speedPreselVal=m;\r\n            this.getText();\r\n        })\r\n\r\n        sub.on('machPreselVal').whenChanged().handle(m => {\r\n            this.machPreselVal = m;\r\n            this.getText();\r\n\r\n        })\r\n\r\n        sub.on('athrModeMessage').whenChanged().handle(m => {\r\n            this.athrModeMessage = m;\r\n            this.getText();\r\n\r\n        })\r\n               \r\n    }\r\n\r\n    render(): VNode  {\r\n\r\n        return (\r\n            <text class=\"FontMedium MiddleAlign Cyan\" x=\"35.275196\" y=\"21.616354\">{this.textSub}</text>\r\n        );\r\n    }\r\n}\r\n\r\nclass B1Cell extends ShowForSecondsComponent<{bus: EventBus, visibility: Subscribable<string>}> {\r\n\r\n    private textSub = Subject.create<string>('V/S');\r\n\r\n    private boxClassSub = Subject.create('');\r\n    private boxPathStringSub = Subject.create('');\r\n\r\n    private activeVerticalModeSub = Subject.create(0);\r\n\r\n    private inProtectionClassSub = Subject.create('Cyan');\r\n\r\n    private speedProtectionPathRef = FSComponent.createRef<SVGPathElement>();\r\n    private inModeReversionPathRef = FSComponent.createRef<SVGPathElement>();\r\n\r\n    private fmaTextRef = FSComponent.createRef<SVGTextElement>();\r\n    private addidionalTextSub = Subject.create('V/S');\r\n\r\n\r\n    private getText(activeVerticalMode: number) {\r\n\r\n        let text: string;\r\n        let additionalText: string = '';\r\n        let inProtection = false;\r\n    \r\n        console.log(activeVerticalMode);\r\n\r\n        switch (activeVerticalMode) {\r\n        case 31:\r\n            text = 'G/S';\r\n            break;\r\n        // case 2:\r\n        //     text = 'F-G/S';\r\n        //     break;\r\n        case 30:\r\n            text = 'G/S*';\r\n            break;\r\n        // case 4:\r\n        //     text = 'F-G/S*';\r\n        //     break;\r\n        case 40:\r\n        case 41:\r\n            text = 'SRS';\r\n            break;\r\n        case 50:\r\n            text = 'TCAS';\r\n            break;\r\n        // case 9:\r\n        //     text = 'FINAL';\r\n        //     break;\r\n        case 23:\r\n            text = 'DES';\r\n            break;\r\n        case 13:\r\n            if (SimVar.GetSimVarValue('L:A32NX_FMA_EXPEDITE_MODE', 'bool')) {\r\n                text = 'EXP DES';\r\n            } else {\r\n                text = 'OP DES';\r\n            }\r\n            break;\r\n        case 22:\r\n            text = 'CLB';\r\n            break;\r\n        case 12:\r\n            if (SimVar.GetSimVarValue('L:A32NX_FMA_EXPEDITE_MODE', 'bool')) {\r\n                text = 'EXP CLB';\r\n            } else {\r\n                text = 'OP CLB';\r\n            }\r\n            break;\r\n        case 10:\r\n            if (SimVar.GetSimVarValue('L:A32NX_FMA_CRUISE_ALT_MODE', 'Bool')) {\r\n                text = 'ALT CRZ';\r\n            } else {\r\n                text = 'ALT';\r\n            }\r\n            break;\r\n        case 11:\r\n            text = 'ALT*';\r\n            break;\r\n        case 21:\r\n            text = 'ALT CST*';\r\n            break;\r\n        case 20:\r\n            text = 'ALT CST';\r\n            break;\r\n        // case 18:\r\n        //     text = 'ALT CRZ';\r\n        //     break;\r\n        case 15: {\r\n            const FPA = SimVar.GetSimVarValue('L:A32NX_AUTOPILOT_FPA_SELECTED', 'Degree');\r\n            inProtection = SimVar.GetSimVarValue('L:A32NX_FMA_SPEED_PROTECTION_MODE', 'bool');\r\n            const FPAText = `${(FPA >= 0 ? '+' : '')}${(Math.round(FPA * 10) / 10).toFixed(1)}`;\r\n    \r\n            text= 'FPA';\r\n            additionalText = FPAText;\r\n            break;\r\n        }\r\n        case 14: {\r\n            const VS = SimVar.GetSimVarValue('L:A32NX_AUTOPILOT_VS_SELECTED', 'feet per minute');\r\n            inProtection = SimVar.GetSimVarValue('L:A32NX_FMA_SPEED_PROTECTION_MODE', 'bool');\r\n            const VSText = `${(VS >= 0 ? '+' : '')}${Math.round(VS).toString()}`.padStart(5, ' ');\r\n    \r\n            text = 'V/S'\r\n\r\n            additionalText = VSText;\r\n            break;\r\n        }\r\n        default:\r\n            text = '';\r\n        }\r\n\r\n        const inSpeedProtection = inProtection && (activeVerticalMode === 14 || activeVerticalMode === 15);\r\n\r\n        if(inSpeedProtection) {\r\n            this.speedProtectionPathRef.instance.setAttribute('visibility','visible');\r\n        } else {\r\n            this.speedProtectionPathRef.instance.setAttribute('visibility','hidden');\r\n        }\r\n\r\n\r\n        //DONE \r\n /*        if(inModeReversion) {\r\n            this.inModeReversionPathRef.instance.setAttribute('visibility','visible');\r\n        } else {\r\n            this.inModeReversionPathRef.instance.setAttribute('visibility','hidden');\r\n        } */\r\n    \r\n        const tcasModeDisarmedMessage = SimVar.GetSimVarValue('L:A32NX_AUTOPILOT_TCAS_MESSAGE_DISARM', 'bool');\r\n    \r\n        const boxclass = inSpeedProtection ? 'NormalStroke None' : 'NormalStroke White';\r\n        this.boxClassSub.set(boxclass);\r\n\r\n\r\n\r\n        const boxPathString = activeVerticalMode === 50 && tcasModeDisarmedMessage ? 'm34.656 1.8143h29.918v13.506h-29.918z' : 'm34.656 1.8143h29.918v6.0476h-29.918z';\r\n\r\n\r\n        this.boxPathStringSub.set(boxPathString);\r\n\r\n        this.textSub.set(text);\r\n        this.addidionalTextSub.set(additionalText);\r\n        \r\n        //console.log(text);\r\n        //console.log(additionalText);\r\n\r\n\r\n\r\n        this.inProtectionClassSub.set(inProtection ? 'PulseCyanFill' : 'Cyan');\r\n\r\n        this.fmaTextRef.instance.innerHTML=`<tspan>${text}</tspan><tspan class=${inProtection ? 'PulseCyanFill' : 'Cyan'}>${additionalText}</tspan>`;\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n        \r\n        sub.on('activeVerticalMode').whenChanged().handle(activeVerticalModem => {\r\n            this.activeVerticalModeSub.set(activeVerticalModem);\r\n            this.getText(activeVerticalModem);\r\n            this.displayModeChangedPath(10000);\r\n        })\r\n\r\n        sub.on('ap_vs_selected').whenChanged().handle(svs => {\r\n\r\n            //FIXME use the svs instead of getSimvar again\r\n            this.getText(this.activeVerticalModeSub.get());  \r\n            this.displayModeChangedPath(10000);\r\n\r\n        });\r\n\r\n        sub.on('fma_mode_reversion').whenChanged().handle(r => {\r\n            this.displayModeChangedPath(10000);\r\n\r\n        if(r) {\r\n            this.inModeReversionPathRef.instance.setAttribute('visibility','visible');\r\n            this.boxClassSub.set('NormalStroke None');\r\n\r\n        } else {\r\n            this.inModeReversionPathRef.instance.setAttribute('visibility','hidden');\r\n            this.boxClassSub.set('NormalStroke White');\r\n        }\r\n        });\r\n\r\n        sub.on('fma_speed_protection').whenChanged().handle(protection => {\r\n            this.displayModeChangedPath(10000);\r\n            if(!protection){\r\n                this.speedProtectionPathRef.instance.setAttribute('visibility','hidden');\r\n            }\r\n        });\r\n\r\n\r\n    }\r\n\r\n    render(): VNode {\r\n\r\n    \r\n        return (\r\n            <g visibility={this.props.visibility}>\r\n               \r\n                <path ref={this.modeChangedPathRef} class={this.boxClassSub} visibility='hidden' d={this.boxPathStringSub} />\r\n               \r\n                <path ref={this.speedProtectionPathRef} class=\"NormalStroke Amber BlinkInfinite\" d=\"m34.656 1.8143h29.918v6.0476h-29.918z\" />\r\n                <path ref={this.inModeReversionPathRef} class=\"NormalStroke White BlinkInfinite\" d=\"m34.656 1.8143h29.918v6.0476h-29.918z\" />\r\n                \r\n                <text ref={this.fmaTextRef}  class=\"FontMedium MiddleAlign Green\" x=\"49.498924\" y=\"6.8785663\" >\r\n                    \r\n                    {/* set directly via innerhtmkl as tspan was invisble for some reason when set here */}\r\n                    \r\n                </text>\r\n            </g>\r\n        );\r\n        \r\n    }\r\n \r\n};\r\n\r\nclass B2Cell extends DisplayComponent<{bus: EventBus}> {\r\n\r\n    private text1Sub = Subject.create('');\r\n    private text2Sub = Subject.create('');\r\n    private classSub = Subject.create('');\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('fmaVerticalArmed').whenChanged().handle(fmv => {\r\n\r\n            const altArmed = (fmv >> 0) & 1;\r\n            const altCstArmed = (fmv >> 1) & 1;\r\n            const clbArmed = (fmv >> 2) & 1;\r\n            const desArmed = (fmv >> 3) & 1;\r\n            const gsArmed = (fmv >> 4) & 1;\r\n            const finalArmed = (fmv >> 5) & 1;\r\n        \r\n            let text1: string;\r\n            let color1 = 'Cyan';\r\n            if (clbArmed) {\r\n                text1 = 'CLB';\r\n            } else if (desArmed) {\r\n                text1 = 'DES';\r\n            } else if (altCstArmed) {\r\n                text1 = 'ALT';\r\n                color1 = 'Magenta';\r\n            } else if (altArmed) {\r\n                text1 = 'ALT';\r\n            } else {\r\n                text1 = '';\r\n            }\r\n        \r\n            let text2;\r\n            // case 1:\r\n            //     text2 = 'F-G/S';\r\n            //     break;\r\n            if (gsArmed) {\r\n                text2 = 'G/S';\r\n            } else if (finalArmed) {\r\n                text2 = 'FINAL';\r\n            } else {\r\n                text2 = '';\r\n            }\r\n\r\n            this.text1Sub.set(text1);\r\n            this.text2Sub.set(text2);\r\n            this.classSub.set(`FontMedium MiddleAlign ${color1}`);\r\n\r\n        });\r\n    }\r\n\r\n    render(): VNode {\r\n    \r\n        return (\r\n            <g>\r\n                <text class={this.classSub} x=\"40.520622\" y=\"14.130308\">{this.text1Sub}</text>\r\n                <text class=\"FontMedium MiddleAlign Cyan\" x=\"55.275803\" y=\"14.143736\">{this.text2Sub}</text>\r\n            </g>\r\n        );\r\n\r\n    }\r\n    \r\n}\r\n\r\nclass C1Cell extends ShowForSecondsComponent<{visibility: Subscribable<string>, bus: EventBus}> {\r\n\r\n    private textSub = Subject.create('');\r\n    private idSub = Subject.create(0);\r\n\r\n\r\n    private activeLateralMode = 0;\r\n    private activeVerticalMode = 0;\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('activeLateralMode').whenChanged().handle(lm => {\r\n            this.activeLateralMode = lm;\r\n            this.updateText(lm, this.activeVerticalMode);\r\n            this.displayModeChangedPath(10000);\r\n        });\r\n\r\n        sub.on('activeVerticalMode').whenChanged().handle(lm => {\r\n            this.activeVerticalMode = lm;\r\n            this.updateText(this.activeLateralMode, lm);\r\n            this.displayModeChangedPath(10000);\r\n        });\r\n    }\r\n\r\n    private updateText(activeLateralMode: number, activeVerticalMode: number) {\r\n\r\n        const armedVerticalBitmask = SimVar.GetSimVarValue('L:A32NX_FMA_VERTICAL_ARMED', 'number');\r\n        const finalArmed = (armedVerticalBitmask >> 5) & 1;\r\n    \r\n    \r\n        let text: string;\r\n        let id = 0;\r\n        if (activeLateralMode === 50) {\r\n            text = 'GA TRK';\r\n            id = 1;\r\n        } else if (activeLateralMode === 30) {\r\n            text = 'LOC *';\r\n            id = 3;\r\n        } else if (activeLateralMode === 10) {\r\n            text = 'HDG';\r\n            id = 5;\r\n        } else if (activeLateralMode === 40) {\r\n            text = 'RWY';\r\n            id = 6;\r\n        } else if (activeLateralMode === 41) {\r\n            text = 'RWY TRK';\r\n            id = 7;\r\n        } else if (activeLateralMode === 11) {\r\n            text = 'TRACK';\r\n            id = 8;\r\n        } else if (activeLateralMode === 31) {\r\n            text = 'LOC';\r\n            id = 10;\r\n        } else if (activeLateralMode === 20 && !finalArmed && activeVerticalMode !== 24) {\r\n            text = 'NAV';\r\n            id = 13;\r\n        } else if (activeLateralMode === 20 && finalArmed && activeVerticalMode !== 24) {\r\n            text = 'APP NAV';\r\n            id = 12;\r\n        } else {\r\n            text = '';\r\n        }\r\n\r\n        this.textSub.set(text);\r\n        this.idSub.set(id);\r\n    }\r\n\r\n    render(): VNode {\r\n      \r\n        // case 2:\r\n        //     text = 'LOC B/C*';\r\n        //     id = 2;\r\n        //     break;\r\n        // case 4:\r\n        //     text = 'F-LOC*';\r\n        //     id = 4;\r\n        //     break;\r\n        // case 9:\r\n        //     text = 'LOC B/C';\r\n        //     id = 9;\r\n        //     break;\r\n        // case 11:\r\n        //     text = 'F-LOC';\r\n        //     id = 11;\r\n        //     break;\r\n        // case 12:\r\n        //     text = 'APP NAV';\r\n        //     id = 12;\r\n        //     break;\r\n    \r\n        return (\r\n            <g visibility={this.props.visibility}>\r\n                <path ref={this.modeChangedPathRef} class=\"NormalStroke White\" visibility='hidden' d=\"m100.87 1.8143v6.0476h-33.075l1e-6 -6.0476z\" />\r\n                <text class=\"FontMedium MiddleAlign Green\" x=\"84.490074\" y=\"6.9027362\">{this.textSub}</text>\r\n            </g>\r\n        );\r\n    }\r\n\r\n\r\n\r\n}\r\n\r\n class C2Cell extends DisplayComponent<{bus: EventBus}> {\r\n\r\n    private fmaLateralArmed: number = 0;\r\n    private fmaVerticalArmed: number = 0;\r\n    private activeVerticalMode: number = 0;\r\n\r\n    private textSub = Subject.create('');\r\n\r\n    private getText() {\r\n        const navArmed = (this.fmaLateralArmed >> 0) & 1;\r\n        const locArmed = (this.fmaLateralArmed >> 1) & 1;\r\n    \r\n        const finalArmed = (this.fmaVerticalArmed >> 5) & 1;\r\n    \r\n        let text: string='';\r\n        if (locArmed) {\r\n            // case 1:\r\n            //     text = 'LOC B/C';\r\n            //     break;\r\n            text = 'LOC';\r\n            // case 3:\r\n            //     text = 'F-LOC';\r\n            //     break;\r\n        } else if (navArmed && (finalArmed || this.activeVerticalMode === 24)) {\r\n            text = 'APP NAV';\r\n        } else if (navArmed) {\r\n            text = 'NAV';\r\n        } \r\n        this.textSub.set(text);\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('fmaLateralArmed').whenChanged().handle(fla => {\r\n            this.fmaLateralArmed = fla;\r\n            this.getText();\r\n        });\r\n\r\n        sub.on('fmaVerticalArmed').whenChanged().handle(fva => {\r\n            this.fmaVerticalArmed = fva;\r\n            this.getText();    \r\n        });\r\n\r\n        sub.on('activeVerticalMode').whenChanged().handle(avm => {\r\n            this.activeVerticalMode = avm;\r\n            this.getText();\r\n        });\r\n    }\r\n\r\n    render(): VNode  {\r\n\r\n    return (\r\n        <text class=\"FontMedium MiddleAlign Cyan\" x=\"84.536842\" y=\"14.130308\">{this.textSub}</text>\r\n    );\r\n    }\r\n    \r\n}; \r\n\r\nclass BC1Cell extends DisplayComponent<{bus:EventBus, visibility: Subscribable<string>}> {\r\n\r\n\r\n    private modeChangedPathRef = FSComponent.createRef<SVGPathElement>();\r\n\r\n    private timeout: number = 0;\r\n\r\n    private lastLateralMode = 0;\r\n    private lastVerticalMode = 0;\r\n    private textSub = Subject.create('');\r\n\r\n    private displayModeChangedPath = (timeout: number) => {\r\n        \r\n        this.modeChangedPathRef.instance.classList.add('ModeChangedPath');\r\n        clearTimeout(this.timeout);\r\n        this.timeout = setTimeout(() => {\r\n            this.modeChangedPathRef.instance.classList.remove('ModeChangedPath');\r\n          }, timeout) as unknown as number;\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('activeVerticalMode').whenChanged().handle(v => {\r\n            this.lastVerticalMode = v;\r\n\r\n            let text: string;\r\n            let id = 0;\r\n            if (this.lastVerticalMode === 34) {\r\n                text = 'ROLL OUT';\r\n                id = 1;\r\n            } else if (this.lastVerticalMode === 33) {\r\n                text = 'FLARE';\r\n                id = 2;\r\n            } else if (this.lastVerticalMode === 32) {\r\n                text = 'LAND';\r\n                id = 3;\r\n            } else if (this.lastVerticalMode === 24 && this.lastLateralMode === 20) {\r\n                text = 'FINAL APP';\r\n                id = 4;\r\n            } else {\r\n                text='';\r\n            }\r\n            if(text !== '') {\r\n                this.displayModeChangedPath(9000);\r\n            }\r\n            this.textSub.set(text);\r\n\r\n        })\r\n\r\n        sub.on('activeLateralMode').whenChanged().handle(l => {\r\n            this.lastLateralMode = l;\r\n\r\n            let text: string;\r\n            let id = 0;\r\n            if (this.lastVerticalMode === 34) {\r\n                text = 'ROLL OUT';\r\n                id = 1;\r\n            } else if (this.lastVerticalMode === 33) {\r\n                text = 'FLARE';\r\n                id = 2;\r\n            } else if (this.lastVerticalMode === 32) {\r\n                text = 'LAND';\r\n                id = 3;\r\n            } else if (this.lastVerticalMode === 24 && this.lastLateralMode === 20) {\r\n                text = 'FINAL APP';\r\n                id = 4;\r\n            } else {\r\n                text='';\r\n            }\r\n            if(text !== '') {\r\n                this.displayModeChangedPath(9000);\r\n            }\r\n            this.textSub.set(text);\r\n        })\r\n    }\r\n\r\n    render(): VNode {\r\n\r\n        return (\r\n            <g>\r\n                <path ref={this.modeChangedPathRef} class=\"NormalStroke White\" visibility='hidden' d=\"m50.178 1.8143h35.174v6.0476h-35.174z\" />\r\n                <text class=\"FontMedium MiddleAlign Green\" x=\"67.9795\" y=\"6.8893085\">{this.textSub}</text>\r\n            </g>\r\n        );\r\n    }\r\n   \r\n}\r\n\r\nconst getBC3Message = (isAttExcessive: boolean) => {\r\n    const armedVerticalBitmask = SimVar.GetSimVarValue('L:A32NX_FMA_VERTICAL_ARMED', 'number');\r\n    const TCASArmed = (armedVerticalBitmask >> 6) & 1;\r\n\r\n    const trkFpaDeselectedTCAS = SimVar.GetSimVarValue('L:A32NX_AUTOPILOT_TCAS_MESSAGE_TRK_FPA_DESELECTION', 'bool');\r\n    const tcasRaInhibited = SimVar.GetSimVarValue('L:A32NX_AUTOPILOT_TCAS_MESSAGE_RA_INHIBITED', 'bool');\r\n\r\n    let text: string;\r\n    let className: string;\r\n    // All currently unused message are set to false\r\n    if (false) {\r\n        text = 'MAN PITCH TRIM ONLY';\r\n        className = 'Red Blink9Seconds';\r\n    } else if (false) {\r\n        text = 'USE MAN PITCH TRIM';\r\n        className = 'PulseAmber9Seconds Amber';\r\n    } else if (false) {\r\n        text = 'FOR GA: SET TOGA';\r\n        className = 'PulseAmber9Seconds Amber';\r\n    } else if (TCASArmed && !isAttExcessive) {\r\n        text = '  TCAS                ';\r\n        className = 'Cyan';\r\n    } else if (false) {\r\n        text = 'DISCONNECT AP FOR LDG';\r\n        className = 'PulseAmber9Seconds Amber';\r\n    } else if (tcasRaInhibited && !isAttExcessive) {\r\n        text = 'TCAS RA INHIBITED';\r\n        className = 'White';\r\n    } else if (trkFpaDeselectedTCAS && !isAttExcessive) {\r\n        text = 'TRK FPA DESELECTED';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'SET GREEN DOT SPEED';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'T/D REACHED';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'MORE DRAG';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'CHECK SPEED MODE';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'CHECK APPR SELECTION';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'TURN AREA EXCEEDANCE';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'SET HOLD SPEED';\r\n        className = 'White';\r\n    } else if (false) {\r\n        text = 'VERT DISCONT AHEAD';\r\n        className = 'Amber';\r\n    } else if (false) {\r\n        text = 'FINAL APP SELECTED';\r\n        className = 'White';\r\n    } else {\r\n        return [null, null];\r\n    }\r\n\r\n    return [text, className];\r\n};\r\n\r\n class BC3Cell extends DisplayComponent<{ isAttExcessive: Subscribable<boolean> }> {\r\n\r\n    private textSub = Subject.create('');\r\n    private classNameSub = Subject.create('');\r\n\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        this.props.isAttExcessive.sub(e => {\r\n            const [text, className] = getBC3Message(e);\r\n            this.classNameSub.set(`FontMedium MiddleAlign ${className}`);\r\n            if(text !== null){\r\n                this.textSub.set(text);\r\n            }\r\n        });\r\n    }\r\n     render(): VNode  {\r\n\r\n        return (\r\n            <text class={this.classNameSub} x=\"67.801949\" y=\"21.481308\" xmlSpace=\"preserve\">{this.textSub}</text>\r\n        );        \r\n     }\r\n}\r\n\r\nclass D1D2Cell extends DisplayComponent<{bus: EventBus, visibility: Subscribable<string>}> {\r\n\r\n    private text1Sub = Subject.create('');\r\n    private text2Sub = Subject.create('');\r\n\r\n    private modeChangedPathRef = FSComponent.createRef<SVGPathElement>();\r\n\r\n    private timeout: number = 0;\r\n\r\n    private displayModeChangedPath = (timeout: number) => {\r\n        \r\n        this.modeChangedPathRef.instance.classList.add('ModeChangedPath');\r\n        clearTimeout(this.timeout);\r\n        this.timeout = setTimeout(() => {\r\n            this.modeChangedPathRef.instance.classList.remove('ModeChangedPath');\r\n          }, timeout) as unknown as number;\r\n    }\r\n\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const bus = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        bus.on('approachCapability').whenChanged().handle(c => {\r\n\r\n            let text1: string;\r\n            let text2: string | undefined;\r\n            switch (c) {\r\n            case 1:\r\n                text1 = 'CAT1';\r\n                break;\r\n            case 2:\r\n                text1 = 'CAT2';\r\n                break;\r\n            case 3:\r\n                text1 = 'CAT3';\r\n                text2 = 'SINGLE';\r\n                break;\r\n            case 4:\r\n                text1 = 'CAT3';\r\n                text2 = 'DUAL';\r\n                break;\r\n            case 5:\r\n                text1 = 'AUTO';\r\n                text2 = 'LAND';\r\n                break;\r\n            case 6:\r\n                text1 = 'F-APP';\r\n                break;\r\n            case 7:\r\n                text1 = 'F-APP';\r\n                text2 = '+ RAW';\r\n                break;\r\n            case 8:\r\n                text1 = 'RAW';\r\n                text2 = 'ONLY';\r\n                break;\r\n            default:\r\n                text1 = '';\r\n            }\r\n        \r\n            const box = text2 ? <path class=\"NormalStroke White\" d=\"m104.1 1.8143h27.994v13.506h-27.994z\" />\r\n                : <path class=\"NormalStroke White\" d=\"m104.1 1.8143h27.994v6.0476h-27.994z\" />;\r\n\r\n            this.text1Sub.set(text1);\r\n            if(text2) {\r\n                this.text2Sub.set(text2);\r\n                this.modeChangedPathRef.instance.setAttribute('d','m104.1 1.8143h27.994v13.506h-27.994z');\r\n            } else {\r\n                this.modeChangedPathRef.instance.setAttribute('d', 'm104.1 1.8143h27.994v6.0476h-27.994z');\r\n            }\r\n            this.displayModeChangedPath(9000);\r\n        });\r\n    }\r\n\r\n    render(): VNode {\r\n\r\n       \r\n    \r\n        return (\r\n            <g visibility={this.props.visibility}>\r\n                <text class=\"FontMedium MiddleAlign White\" x=\"118.09216\" y=\"7.0131598\">{this.text1Sub}</text> \r\n                <text class=\"FontMedium MiddleAlign White\" x=\"118.15831\" y=\"14.130308\">{this.text2Sub}</text>\r\n                <path ref={this.modeChangedPathRef} class=\"NormalStroke White\" visibility='hidden'></path>\r\n            </g>\r\n        );\r\n    }\r\n  \r\n};\r\n \r\nclass D3Cell extends DisplayComponent<{bus: EventBus}> {\r\n\r\n    private textRef = FSComponent.createRef<SVGTextElement>();\r\n\r\n    private classNameSub = Subject.create('');\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('mda').whenChanged().handle(mda => {\r\n\r\n            if (mda !== 0) {\r\n                const MDAText = Math.round(mda).toString().padStart(6, ' ');\r\n                \r\n                    \r\n                      this.textRef.instance.innerHTML=  `<tspan>BARO</tspan>\r\n                        <tspan class=\"Cyan\" xmlSpace=\"preserve\">${MDAText}</tspan>`\r\n                    \r\n            }        \r\n        });\r\n\r\n        sub.on('dh').whenChanged().handle(dh => {\r\n            let fontSize = 'FontSmallest';\r\n\r\n            if (dh !== -1 && dh !== -2) {\r\n                const DHText = Math.round(dh).toString().padStart(4, ' ');\r\n                \r\n                  this.textRef.instance.innerHTML=`\r\n                        <tspan>RADIO</tspan>\r\n                        <tspan class=\"Cyan\" xmlSpace=\"preserve\">${DHText}</tspan>\r\n                    `\r\n                \r\n            } else if (dh === -2) {\r\n                this.textRef.instance.innerHTML= '<tspan>NO DH</tspan>';\r\n                fontSize = 'FontMedium';\r\n            } else {\r\n                this.textRef.instance.innerHTML= '';\r\n            }\r\n            this.classNameSub.set(`${fontSize} MiddleAlign White`);\r\n        });\r\n\r\n    }\r\n\r\n\r\n    render(): VNode  {\r\n        return (\r\n            <text ref={this.textRef} class={this.classNameSub} x=\"118.1583\" y=\"21.188744\"></text>\r\n        );\r\n    }\r\n}\r\n\r\n\r\n\r\n\r\nclass E1Cell extends ShowForSecondsComponent<{bus: EventBus}> {\r\n\r\n    private ap1Active = false;\r\n    private ap2Active = false;\r\n\r\n    private textSub = Subject.create('');\r\n\r\n    private setText() {\r\n        let text: string;\r\n        let id = 0;\r\n        if (this.ap1Active && !this.ap2Active) {\r\n            text = 'AP1';\r\n            id = 1;\r\n        } else if (this.ap2Active && !this.ap1Active) {\r\n            text = 'AP2';\r\n            id = 2;\r\n        \r\n        } else if (!this.ap2Active && !this.ap1Active) {\r\n            text = '';\r\n        } else {\r\n            text = 'AP1+2';\r\n            id = 3;\r\n        }\r\n        this.textSub.set(text);\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('ap1Active').whenChanged().handle(ap => {\r\n            this.ap1Active = ap;\r\n            this.displayModeChangedPath(9000);\r\n            this.setText();\r\n        });\r\n\r\n        sub.on('ap2Active').whenChanged().handle(ap => {\r\n            this.ap2Active = ap;\r\n            this.displayModeChangedPath(9000);\r\n            this.setText();\r\n        });\r\n\r\n\r\n\r\n    }\r\n    render(): VNode  {\r\n    \r\n        return (\r\n            <g>\r\n                <path ref={this.modeChangedPathRef} visibility='hidden' class=\"NormalStroke White\" d=\"m156.13 1.8143v6.0476h-20.81v-6.0476z\" />\r\n                <text class=\"FontMedium MiddleAlign White\" x=\"145.61546\" y=\"6.9559975\">{this.textSub}</text>\r\n            </g>\r\n        );\r\n    }\r\n\r\n\r\n   \r\n}\r\n\r\n\r\n\r\nclass E2Cell extends DisplayComponent<{bus: EventBus}> {\r\n\r\n    private fd1Active = false;\r\n    private fd2Active = false;\r\n    private ap1Active = false;\r\n    private ap2Active = false;\r\n\r\n    private textSub = Subject.create('');\r\n\r\n    private getText() {\r\n        if (!this.ap1Active && !this.ap2Active && !this.fd1Active && !this.fd2Active) {\r\n            console.log(\"END ME\");\r\n            this.textSub.set('');\r\n        } else {\r\n            const text = `${this.fd1Active  ? '1' : '-'} FD ${this.fd2Active ? '2' : '-'}`;\r\n            this.textSub.set(text);\r\n        }\r\n\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('fd1Active').whenChanged().handle(fd => {\r\n            console.log(\"FD 1\" +fd);\r\n            this.fd1Active = fd;\r\n            this.getText();\r\n\r\n        })\r\n\r\n        sub.on('ap1Active').whenChanged().handle(fd => {\r\n            this.ap1Active = fd;\r\n            this.getText();\r\n\r\n        })\r\n\r\n        sub.on('ap2Active').whenChanged().handle(fd => {\r\n            this.ap2Active = fd;\r\n            this.getText();\r\n\r\n        })\r\n\r\n        sub.on('fd2Active').whenChanged().handle(fd => {\r\n            this.fd2Active = fd;\r\n            this.getText();\r\n        })\r\n    }\r\n\r\n    render(): VNode {\r\n        \r\n \r\n    return (\r\n        <text class=\"FontMedium MiddleAlign White\" x=\"145.8961\" y=\"14.218581\">{this.textSub}</text>\r\n    )\r\n    }\r\n\r\n}\r\n\r\nclass E3Cell extends ShowForSecondsComponent<{bus: EventBus}> {\r\n\r\n    private classSub = Subject.create('');\r\n\r\n    private getClass(athrStatus: number) {\r\n        let color: string='';\r\n        switch (athrStatus) {\r\n        case 1:\r\n            color = 'Cyan';\r\n            break;\r\n        case 2:\r\n            color = 'White';\r\n            break; \r\n        }\r\n        this.classSub.set(`FontMedium MiddleAlign ${color}`);\r\n    }\r\n\r\n    onAfterRender(node: VNode): void {\r\n        super.onAfterRender(node);\r\n\r\n        const sub = this.props.bus.getSubscriber<PFDSimvars>();\r\n\r\n        sub.on('athrStatus').whenChanged().handle(a => {\r\n            this.getClass(a);\r\n            this.displayModeChangedPath(9000);\r\n        })\r\n\r\n    }\r\n    render(): VNode  {\r\n\r\n        return (\r\n            <g>\r\n                <path ref={this.modeChangedPathRef} class=\"NormalStroke White\" visibility='hidden' d=\"m135.32 16.329h20.81v6.0476h-20.81z\" />\r\n                <text class={this.classSub} x=\"145.75578\" y=\"21.434536\">A/THR</text>\r\n            </g>\r\n        );\r\n    }\r\n  \r\n}; \r\n\r\n"]}