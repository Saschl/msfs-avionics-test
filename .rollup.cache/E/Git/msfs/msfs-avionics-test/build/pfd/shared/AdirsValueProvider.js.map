{"version":3,"file":"AdirsValueProvider.js","sourceRoot":"","sources":["../../../pfd/shared/AdirsValueProvider.tsx"],"names":[],"mappings":"AAAA,OAAO,EAAY,eAAe,EAAE,MAAM,SAAS,CAAC;AAGpD,MAAM,OAAO,kBAAkB;IAG3B,YAAY,GAAa,EAAE,SAA6B;QACpD,MAAM,GAAG,GAAG,GAAG,CAAC,aAAa,EAAc,CAAC;QAC5C,MAAM,GAAG,GAAG,QAAQ,CAAC,oBAAoB,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;QAC9E,MAAM,YAAY,GAAG,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAS,CAAC,GAAG,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QAE3E,GAAG,CAAC,EAAE,CAAC,YAAY,CAAC,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;YAE1C,MAAM,cAAc,GAAG,WAAW,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;YACpD,SAAS,CAAC,kBAAkB,CAAC,UAAU,EAAC,EAAC,IAAI,EAAE,oBAAoB,cAAc,iBAAiB,EAAC,IAAI,EAAE,eAAe,CAAC,MAAM,EAAC,CAAC,CAAA;YACjI,SAAS,CAAC,kBAAkB,CAAC,OAAO,EAAC,EAAC,IAAI,EAAE,oBAAoB,cAAc,QAAQ,EAAC,IAAI,EAAE,eAAe,CAAC,MAAM,EAAC,CAAC,CAAA;YACrH,SAAS,CAAC,kBAAkB,CAAC,MAAM,EAAC,EAAC,IAAI,EAAE,oBAAoB,cAAc,OAAO,EAAC,IAAI,EAAE,eAAe,CAAC,MAAM,EAAC,CAAC,CAAA;YACnH,SAAS,CAAC,kBAAkB,CAAC,SAAS,EAAC,EAAC,IAAI,EAAE,oBAAoB,cAAc,UAAU,EAAC,IAAI,EAAE,eAAe,CAAC,MAAM,EAAC,CAAC,CAAA;QAE7H,CAAC,CAAC,CAAA;QAEF,GAAG,CAAC,EAAE,CAAC,SAAS,CAAC,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;YAEvC,MAAM,SAAS,GAAG,WAAW,CAAC,YAAY,EAAE,CAAC,CAAC,CAAC;YAC/C,SAAS,CAAC,kBAAkB,CAAC,OAAO,EAAC,EAAC,IAAI,EAAE,qBAAqB,SAAS,oBAAoB,EAAC,IAAI,EAAE,eAAe,CAAC,MAAM,EAAC,CAAC,CAAA;YAC7H,SAAS,CAAC,kBAAkB,CAAC,SAAS,EAAC,EAAC,IAAI,EAAE,qBAAqB,SAAS,4BAA4B,EAAC,IAAI,EAAE,eAAe,CAAC,MAAM,EAAC,CAAC,CAAA;YACvI,SAAS,CAAC,kBAAkB,CAAC,UAAU,EAAC,EAAC,IAAI,EAAE,qBAAqB,SAAS,WAAW,EAAC,IAAI,EAAE,eAAe,CAAC,MAAM,EAAC,CAAC,CAAA;QAE3H,CAAC,CAAC,CAAC;IACP,CAAC;CACJ;AACD,MAAM,aAAa,GAAG,CAAC,YAAgC,EAAE,EAAE,CAAC,YAAY,KAAK,CAAC,CAAC;AAE/E,MAAM,WAAW,GAAG,CAAC,YAAgC,EAAE,SAAiB,EAAE,EAAE;IACxE,MAAM,eAAe,GAAG,CAAC,CAAC;IAC1B,MAAM,UAAU,GAAG,CAAC,CAAC;IAErB,IAAI,aAAa,CAAC,YAAY,CAAC,EAAE;QAC7B,OAAO,SAAS,KAAK,eAAe,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;KAChD;IACD,OAAO,SAAS,KAAK,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AAC5C,CAAC,CAAC","sourcesContent":["import { EventBus, SimVarValueType } from \"msfssdk\";\r\nimport { PFDSimvarPublisher, PFDSimvars } from \"./PFDSimvarPublisher\";\r\n\r\nexport class AdirsValueProvider {\r\n\r\n\r\n    constructor(bus: EventBus, pfdSimvar: PFDSimvarPublisher) {\r\n        const sub = bus.getSubscriber<PFDSimvars>();\r\n        const url = document.getElementsByTagName('a32nx-pfd')[0].getAttribute('url');\r\n        const displayIndex = url ? parseInt(url.substring(url.length - 1), 10) : 0;\r\n\r\n        sub.on('attHdgKnob').whenChanged().handle(k => {\r\n        \r\n            const inertialSource = getSupplier(displayIndex, k);\r\n            pfdSimvar.updateSimVarSource('vs_inert',{name :`L:A32NX_ADIRS_IR_${inertialSource}_VERTICAL_SPEED`,type: SimVarValueType.Number})\r\n            pfdSimvar.updateSimVarSource('pitch',{name :`L:A32NX_ADIRS_IR_${inertialSource}_PITCH`,type: SimVarValueType.Number})\r\n            pfdSimvar.updateSimVarSource('roll',{name :`L:A32NX_ADIRS_IR_${inertialSource}_ROLL`,type: SimVarValueType.Number})\r\n            pfdSimvar.updateSimVarSource('heading',{name :`L:A32NX_ADIRS_IR_${inertialSource}_HEADING`,type: SimVarValueType.Number})\r\n\r\n        })\r\n\r\n        sub.on('airKnob').whenChanged().handle(a => {\r\n\r\n            const airSource = getSupplier(displayIndex, a);\r\n            pfdSimvar.updateSimVarSource('speed',{name :`L:A32NX_ADIRS_ADR_${airSource}_COMPUTED_AIRSPEED`,type: SimVarValueType.Number})\r\n            pfdSimvar.updateSimVarSource('vs_baro',{name :`L:A32NX_ADIRS_ADR_${airSource}_BAROMETRIC_VERTICAL_SPEED`,type: SimVarValueType.Number})\r\n            pfdSimvar.updateSimVarSource('altitude',{name :`L:A32NX_ADIRS_ADR_${airSource}_ALTITUDE`,type: SimVarValueType.Number})\r\n\r\n        }); \r\n    }\r\n}\r\nconst isCaptainSide = (displayIndex: number | undefined) => displayIndex === 1;\r\n\r\nconst getSupplier = (displayIndex: number | undefined, knobValue: number) => {\r\n    const adirs3ToCaptain = 0;\r\n    const adirs3ToFO = 2;\r\n\r\n    if (isCaptainSide(displayIndex)) {\r\n        return knobValue === adirs3ToCaptain ? 3 : 1;\r\n    }\r\n    return knobValue === adirs3ToFO ? 3 : 2;\r\n};\r\n\r\n"]}